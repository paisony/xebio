<?xml version="1.0" encoding="utf-8"?>
<sql-included>
	<sql-list>
		<sql id="V01019-01">
			<statement type="final" name="final">
				<parts>
					SELECT 
						TENPO_CD
						,TENPO_NM
/**						,TENPOKANA_NM
						,TENPOSEISIKI_NM
						,TENPOKEITAI_KB
						,TENPOGYOTAI_KB
						,TENPOYUBIN_NBR1
						,TENPOYUBIN_NBR2
						,TENPOJYUSYO_NM1
						,TENPOJYUSYO_NM2
						,TENPOTEL_NBR
						,TENPOFAX_NBR
						,AREA_CD
						,ADD_YMD
						,ADD_TM
						,ADDTAN_CD
						,UPD_YMD
						,UPD_TM
						,UPD_TANCD
						,SAKUJYO_YMD
						,SAKUJYO_FLG
						,JYUSIN_YMD
						,JYUSIN_TM
**/						,TANAOROSIKIJUN_YMD_KONKAI
						,TANAOROSIJISSI_YMD_KONKAI
						,TANAOROSIKIKAN_FROM_KONKAI
						,TANAOROSIKIKAN_TO_KONAKI
						,TANAOROSIKIJUN_YMD_ZENKAI
						,TANAOROSIJISSI_YMD_ZENKAI
						,TANAOROSIKIKAN_FROM_ZENKAI
						,TANAOROSIKIKAN_TO_ZENKAI
					FROM(
						SELECT 
							MAX(TENPO_CD)			TENPO_CD
							,MAX(TENPO_NM)			TENPO_NM
							,MAX(TENPOKANA_NM)		TENPOKANA_NM
							,MAX(TENPOSEISIKI_NM)	TENPOSEISIKI_NM
							,MAX(TENPOKEITAI_KB)	TENPOKEITAI_KB
							,MAX(TENPOGYOTAI_KB)	TENPOGYOTAI_KB
							,MAX(TENPOYUBIN_NBR1)	TENPOYUBIN_NBR1
							,MAX(TENPOYUBIN_NBR2)	TENPOYUBIN_NBR2
							,MAX(TENPOJYUSYO_NM1)	TENPOJYUSYO_NM1
							,MAX(TENPOJYUSYO_NM2)	TENPOJYUSYO_NM2
							,MAX(TENPOTEL_NBR)		TENPOTEL_NBR
							,MAX(TENPOFAX_NBR)		TENPOFAX_NBR
							,MAX(AREA_CD)			AREA_CD
							,MAX(ADD_YMD)			ADD_YMD
							,MAX(ADD_TM)			ADD_TM
							,MAX(ADDTAN_CD)			ADDTAN_CD
							,MAX(UPD_YMD)			UPD_YMD
							,MAX(UPD_TM)			UPD_TM
							,MAX(UPD_TANCD)			UPD_TANCD
							,MAX(SAKUJYO_YMD)		SAKUJYO_YMD
							,MAX(SAKUJYO_FLG)		SAKUJYO_FLG
							,MAX(JYUSIN_YMD)		JYUSIN_YMD
							,MAX(JYUSIN_TM)			JYUSIN_TM
							,MAX(CASE WHEN ROWNUM = 1 THEN TANAOROSIKIJUN_YMD  ELSE NULL END ) TANAOROSIKIJUN_YMD_KONKAI
							,MAX(CASE WHEN ROWNUM = 1 THEN TANAOROSIJISSI_YMD  ELSE NULL END ) TANAOROSIJISSI_YMD_KONKAI
							,MAX(CASE WHEN ROWNUM = 1 THEN TANAOROSIKIKAN_FROM ELSE NULL END ) TANAOROSIKIKAN_FROM_KONKAI
							,MAX(CASE WHEN ROWNUM = 1 THEN TANAOROSIKIKAN_TO   ELSE NULL END ) TANAOROSIKIKAN_TO_KONAKI
							,MAX(CASE WHEN ROWNUM = 2 THEN TANAOROSIKIJUN_YMD  ELSE NULL END ) TANAOROSIKIJUN_YMD_ZENKAI
							,MAX(CASE WHEN ROWNUM = 2 THEN TANAOROSIJISSI_YMD  ELSE NULL END ) TANAOROSIJISSI_YMD_ZENKAI
							,MAX(CASE WHEN ROWNUM = 2 THEN TANAOROSIKIKAN_FROM ELSE NULL END ) TANAOROSIKIKAN_FROM_ZENKAI
							,MAX(CASE WHEN ROWNUM = 2 THEN TANAOROSIKIKAN_TO   ELSE NULL END ) TANAOROSIKIKAN_TO_ZENKAI
						 FROM(
							SELECT
								M1.TENPO_CD
								,M1.TENPO_NM
								,M1.TENPOKANA_NM
								,M1.TENPOSEISIKI_NM
								,M1.TENPOKEITAI_KB
								,M1.TENPOGYOTAI_KB
								,M1.TENPOYUBIN_NBR1
								,M1.TENPOYUBIN_NBR2
								,M1.TENPOJYUSYO_NM1
								,M1.TENPOJYUSYO_NM2
								,M1.TENPOTEL_NBR
								,M1.TENPOFAX_NBR
								,M1.AREA_CD
								,M1.ADD_YMD
								,M1.ADD_TM
								,M1.ADDTAN_CD
								,M1.UPD_YMD
								,M1.UPD_TM
								,M1.UPD_TANCD
								,M1.SAKUJYO_YMD
								,M1.SAKUJYO_FLG
								,M1.JYUSIN_YMD
								,M1.JYUSIN_TM
								,T2.TANAOROSIKIJUN_YMD 
								,T2.TANAOROSIJISSI_YMD 
							    ,T2.TANAOROSIKIKAN_FROM
							    ,T2.TANAOROSIKIKAN_TO  
							FROM BOMT0010 M1
							LEFT JOIN MDIT0030 T2
							ON	M1.TENPO_CD		    = T2.TENCD
							WHERE M1.TENPO_CD		= </parts><bind id="TENPO_CD" /><parts>
							AND   M1.SAKUJYO_FLG    = 0
							ORDER BY T2.TANAOROSIKIJUN_YMD DESC
						)
						WHERE ROWNUM &lt;= 2
						GROUP BY TENPO_CD
					) 
				</parts>		  
			</statement>
			<statement type="replace" name="ADD_WHERE" />
		</sql>
	
		
	
	</sql-list>
</sql-included>
