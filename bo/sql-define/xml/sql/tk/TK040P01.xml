<?xml version="1.0" encoding="utf-8"?>
<sql-included>
	<sql-list>
		/** ロケーション検索(件数チェック) **/
		<sql id="TK040P01-01">
			<statement type="final" name="final">
				<parts>
					SELECT
					COUNT(*) CNT
					FROM
					(
					SELECT
					MAX(BUMON_CD)			BUMON_CD
					,MAX(HINSYU_CD)			HINSYU_CD
					,MAX(BURANDO_CD)		BURANDO_CD
					,MAX(JISYA_HBN)			JISYA_HBN
					,MAX(MAKER_HBN)			MAKER_HBN
					,MAX(SYONMK)			SYONMK
					,MAX(HANBAIKANRYO_YMD)	HANBAIKANRYO_YMD
					,MAX(SIZE_NM)			SIZE_NM
					,MAX(JAN_CD)			JAN_CD
					,MAX(SYOHIN_CD)			SYOHIN_CD
					,FACE_NO				FACE_NO
					,TANA_DAN				TANA_DAN
					,SUM(TANAOROSIGOKEI_SU)	TANAOROSIGOKEI_SU
					FROM
					(
					SELECT
					MDIT0011.TENPO_CD					AS	TENPO_CD
					,MDIT0011.TANAOROSI_YMD				AS	TANAOROSI_YMD
					,MDIT0011.BUMON_CD					AS	BUMON_CD
					,MDIT0011.HINSYU_CD					AS	HINSYU_CD
					,MDIT0011.BURANDO_CD				AS	BURANDO_CD
					,MDIT0011.JISYA_HBN					AS	JISYA_HBN
					,MDIT0011.MAKER_HBN					AS	MAKER_HBN
					,MDIT0011.SYONMK					AS	SYONMK
					,NVL(MDMT0130.HANBAIKANRYO_YMD, 0)	AS	HANBAIKANRYO_YMD
					,MDIT0011.SIZE_NM					AS	SIZE_NM
					,MDIT0011.JAN_CD					AS	JAN_CD
					,MDIT0011.SYOHIN_CD					AS	SYOHIN_CD
					,MDIT0011.FACE_NO					AS	FACE_NO
					,MDIT0011.TANA_DAN					AS	TANA_DAN
					,MDIT0011.TANAOROSIGOKEI_SU			AS	TANAOROSIGOKEI_SU
					FROM
					MDIT0011
					INNER	JOIN	MDIT0010
					ON		MDIT0011.TENPO_CD		=	MDIT0010.TENPO_CD
					AND		MDIT0011.FACE_NO		=	MDIT0010.FACE_NO
					AND		MDIT0011.TANA_DAN		=	MDIT0010.TANA_DAN
					AND		MDIT0011.KAI_SU			=	MDIT0010.KAI_SU
					AND		MDIT0011.TANAOROSI_YMD	=	MDIT0010.TANAOROSI_YMD
					AND		MDIT0011.SOSINKAI_SU	=	MDIT0010.SOSINKAI_SU
					LEFT	JOIN	MDMT0130
					ON		MDIT0011.JAN_CD			=	MDMT0130.JAN_CD

					WHERE	0=0
					AND		MDIT0010.SOSINZUMI_FLG	=	1

					UNION	ALL

					SELECT
					MDIT0091.TENPO_CD					AS	TENPO_CD
					,MDIT0091.TANAOROSI_YMD				AS	TANAOROSI_YMD
					,MDIT0091.BUMON_CD					AS	BUMON_CD
					,MDIT0091.HINSYU_CD					AS	HINSYU_CD
					,MDIT0091.BURANDO_CD				AS	BURANDO_CD
					,MDIT0091.JISYA_HBN					AS	JISYA_HBN
					,MDIT0091.MAKER_HBN					AS	MAKER_HBN
					,MDIT0091.SYONMK					AS	SYONMK
					,NVL(MDMT0130.HANBAIKANRYO_YMD, 0)	AS	HANBAIKANRYO_YMD
					,MDIT0091.SIZE_NM					AS	SIZE_NM
					,MDIT0091.JAN_CD					AS	JAN_CD
					,MDIT0091.SYOHIN_CD					AS	SYOHIN_CD
					,MDIT0091.FACE_NO					AS	FACE_NO
					,MDIT0091.TANA_DAN					AS	TANA_DAN
					,MDIT0091.TANAOROSIGOKEI_SU			AS	TANAOROSIGOKEI_SU
					FROM
					MDIT0091
					INNER	JOIN	MDIT0090
					ON		MDIT0091.TENPO_CD		=	MDIT0090.TENPO_CD
					AND		MDIT0091.FACE_NO		=	MDIT0090.FACE_NO
					AND		MDIT0091.TANA_DAN		=	MDIT0090.TANA_DAN
					AND		MDIT0091.KAI_SU			=	MDIT0090.KAI_SU
					AND		MDIT0091.TANAOROSI_YMD	=	MDIT0090.TANAOROSI_YMD
					LEFT	JOIN	MDMT0130
					ON		MDIT0091.JAN_CD			=	MDMT0130.JAN_CD
					) T1

					WHERE 0=0
				</parts>
			</statement>			
			<!--抽出条件：店舗コード-->
			<statement type="replace" name="REPLACE_ID_TENPO_CD"/>
			<!--抽出条件：棚卸日-->
			<statement type="replace" name="REPLACE_ID_TANAOROSI_YMD"/>
			<!--抽出条件：部門コード FROM-->
			<statement type="replace" name="REPLACE_ID_BUMON_CD_FROM"/>
			<!--抽出条件：部門コード TO-->
			<statement type="replace" name="REPLACE_ID_BUMON_CD_TO"/>
			<!--抽出条件：販売完了日 FROM-->
			<statement type="replace" name="REPLACE_ID_HANBAIKANRYO_YMD_FROM"/>
			<!--抽出条件：販売完了日 TO-->
			<statement type="replace" name="REPLACE_ID_HANBAIKANRYO_YMD_TO"/>
			<!--抽出条件：自社品番-->
			<statement type="replace" name="REPLACE_ID_JISYA_HBN"/>
			<!--抽出条件：スキャンコード-->
			<statement type="replace" name="REPLACE_ID_SCAN_CD"/>

			<statement type="final" name="final">
				<parts>
					GROUP BY
					 FACE_NO
					,TANA_DAN
					,JAN_CD
					
					)
				</parts>
			</statement>
		</sql>
		
		/** ロケーション検索(検索ボタン) **/
		<sql id="TK040P01-02">
			<statement type="final" name="final">
				<parts>
					SELECT
					MAX(BUMON_CD)			BUMON_CD
					,MAX(BUMONKANA_NM)		BUMONKANA_NM
					,MAX(HINSYU_CD)			HINSYU_CD
					,MAX(HINSYU_RYAKU_NM)	HINSYU_RYAKU_NM
					,MAX(BURANDO_CD)		BURANDO_CD
					,MAX(BURANDO_NMK)		BURANDO_NMK
					,MAX(JISYA_HBN)			JISYA_HBN
					,MAX(MAKER_HBN)			MAKER_HBN
					,MAX(SYONMK)			SYONMK
					,MAX(HANBAIKANRYO_YMD)	HANBAIKANRYO_YMD
					,MAX(IRO_NM)			IRO_NM
					,MAX(SIZE_NM)			SIZE_NM
					,MAX(JAN_CD)			JAN_CD
					,MAX(SYOHIN_CD)			SYOHIN_CD
					,FACE_NO				FACE_NO
					,TANA_DAN				TANA_DAN
					,SUM(TANAOROSIGOKEI_SU)	TANAOROSIGOKEI_SU
					,MIN(SOSINZUMI_FLG)		SOSINZUMI_FLG
					FROM
					(
					SELECT
					MDIT0011.TENPO_CD					AS	TENPO_CD
					,MDIT0011.TANAOROSI_YMD				AS	TANAOROSI_YMD
					,MDIT0011.BUMON_CD					AS	BUMON_CD
					,BOMT0060.BUMONKANA_NM				AS	BUMONKANA_NM
					,MDIT0011.HINSYU_CD					AS	HINSYU_CD
					,MDMT0070.HINSYU_RYAKU_NM			AS	HINSYU_RYAKU_NM
					,MDIT0011.BURANDO_CD				AS	BURANDO_CD
					,STMT0500.BURANDO_NMK				AS	BURANDO_NMK
					,MDIT0011.JISYA_HBN					AS	JISYA_HBN
					,MDIT0011.MAKER_HBN					AS	MAKER_HBN
					,MDIT0011.SYONMK					AS	SYONMK
					,NVL(MDMT0130.HANBAIKANRYO_YMD, 0)	AS	HANBAIKANRYO_YMD
					,MDMT0080.IRO_NM					AS	IRO_NM
					,MDIT0011.SIZE_NM					AS	SIZE_NM
					,MDIT0011.JAN_CD					AS	JAN_CD
					,MDIT0011.SYOHIN_CD					AS	SYOHIN_CD
					,MDIT0011.FACE_NO					AS	FACE_NO
					,MDIT0011.TANA_DAN					AS	TANA_DAN
					,MDIT0011.TANAOROSIGOKEI_SU			AS	TANAOROSIGOKEI_SU
					,MDIT0010.SOSINZUMI_FLG				AS	SOSINZUMI_FLG
					FROM
					MDIT0011
					INNER	JOIN	MDIT0010
					ON		MDIT0011.TENPO_CD		=	MDIT0010.TENPO_CD
					AND		MDIT0011.FACE_NO		=	MDIT0010.FACE_NO
					AND		MDIT0011.TANA_DAN		=	MDIT0010.TANA_DAN
					AND		MDIT0011.KAI_SU			=	MDIT0010.KAI_SU
					AND		MDIT0011.TANAOROSI_YMD	=	MDIT0010.TANAOROSI_YMD
					AND		MDIT0011.SOSINKAI_SU	=	MDIT0010.SOSINKAI_SU
					LEFT	JOIN	BOMT0060
					ON		MDIT0011.BUMON_CD		=	BOMT0060.BUMON_CD
					LEFT	JOIN	MDMT0070
					ON		MDIT0011.BUMON_CD		=	MDMT0070.BUMON_CD
					AND		MDIT0011.HINSYU_CD		=	MDMT0070.HINSYU_CD
					LEFT	JOIN	STMT0500
					ON		MDIT0011.BURANDO_CD		=	STMT0500.BURANDO_CD
					LEFT	JOIN	MDMT0130
					ON		MDIT0011.JAN_CD			=	MDMT0130.JAN_CD
					LEFT	JOIN	MDMT0080
					ON		MDIT0011.IRO_CD			=	MDMT0080.IRO_CD
					WHERE	0=0
					AND		MDIT0010.SOSINZUMI_FLG	=	1

					UNION	ALL

					SELECT
					MDIT0091.TENPO_CD					AS	TENPO_CD
					,MDIT0091.TANAOROSI_YMD				AS	TANAOROSI_YMD
					,MDIT0091.BUMON_CD					AS	BUMON_CD
					,BOMT0060.BUMONKANA_NM				AS	BUMONKANA_NM
					,MDIT0091.HINSYU_CD					AS	HINSYU_CD
					,MDMT0070.HINSYU_RYAKU_NM			AS	HINSYU_RYAKU_NM
					,MDIT0091.BURANDO_CD				AS	BURANDO_CD
					,STMT0500.BURANDO_NMK				AS	BURANDO_NMK
					,MDIT0091.JISYA_HBN					AS	JISYA_HBN
					,MDIT0091.MAKER_HBN					AS	MAKER_HBN
					,MDIT0091.SYONMK					AS	SYONMK
					,NVL(MDMT0130.HANBAIKANRYO_YMD, 0)	AS	HANBAIKANRYO_YMD
					,MDMT0080.IRO_NM					AS	IRO_NM
					,MDIT0091.SIZE_NM					AS	SIZE_NM
					,MDIT0091.JAN_CD					AS	JAN_CD
					,MDIT0091.SYOHIN_CD					AS	SYOHIN_CD
					,MDIT0091.FACE_NO					AS	FACE_NO
					,MDIT0091.TANA_DAN					AS	TANA_DAN
					,MDIT0091.TANAOROSIGOKEI_SU			AS	TANAOROSIGOKEI_SU
					,0									AS	SOSINZUMI_FLG
					FROM
					MDIT0091
					INNER	JOIN	MDIT0090
					ON		MDIT0091.TENPO_CD		=	MDIT0090.TENPO_CD
					AND		MDIT0091.FACE_NO		=	MDIT0090.FACE_NO
					AND		MDIT0091.TANA_DAN		=	MDIT0090.TANA_DAN
					AND		MDIT0091.KAI_SU			=	MDIT0090.KAI_SU
					AND		MDIT0091.TANAOROSI_YMD	=	MDIT0090.TANAOROSI_YMD
					LEFT	JOIN	BOMT0060
					ON		MDIT0091.BUMON_CD		=	BOMT0060.BUMON_CD
					LEFT	JOIN	MDMT0070
					ON		MDIT0091.BUMON_CD		=	MDMT0070.BUMON_CD
					AND		MDIT0091.HINSYU_CD		=	MDMT0070.HINSYU_CD
					LEFT	JOIN	STMT0500
					ON		MDIT0091.BURANDO_CD		=	STMT0500.BURANDO_CD
					LEFT	JOIN	MDMT0130
					ON		MDIT0091.JAN_CD			=	MDMT0130.JAN_CD
					LEFT	JOIN	MDMT0080
					ON		MDIT0091.IRO_CD			=	MDMT0080.IRO_CD
					) T1
				</parts>
			</statement>

			<statement type="final" name="final">
				<parts>
					WHERE 0=0
				</parts>
			</statement>

			<!--抽出条件：店舗コード-->
			<statement type="replace" name="REPLACE_ID_TENPO_CD"/>
			<!--抽出条件：棚卸日-->
			<statement type="replace" name="REPLACE_ID_TANAOROSI_YMD"/>
			<!--抽出条件：部門コード FROM-->
			<statement type="replace" name="REPLACE_ID_BUMON_CD_FROM"/>
			<!--抽出条件：部門コード TO-->
			<statement type="replace" name="REPLACE_ID_BUMON_CD_TO"/>
			<!--抽出条件：販売完了日 FROM-->
			<statement type="replace" name="REPLACE_ID_HANBAIKANRYO_YMD_FROM"/>
			<!--抽出条件：販売完了日 TO-->
			<statement type="replace" name="REPLACE_ID_HANBAIKANRYO_YMD_TO"/>
			<!--抽出条件：自社品番-->
			<statement type="replace" name="REPLACE_ID_JISYA_HBN"/>
			<!--抽出条件：スキャンコード-->
			<statement type="replace" name="REPLACE_ID_SCAN_CD"/>

			<statement type="final" name="final">
				<parts>
					GROUP BY
						 FACE_NO
						,TANA_DAN
						,JAN_CD
				</parts>
			</statement>

			<statement type="final" name="final">
				<parts>
					ORDER BY
						 BUMON_CD
						,HINSYU_CD
						,BURANDO_CD
						,MAKER_HBN
						,IRO_NM
						,SIZE_NM
						,TANAOROSIGOKEI_SU DESC
						,FACE_NO
						,TANA_DAN
				</parts>
			</statement>
		</sql>
	</sql-list>
</sql-included>